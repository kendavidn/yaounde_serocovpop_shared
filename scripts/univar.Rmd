---
title: "Univariate plots of Yaounde COVID study data"
date: "`r Sys.Date()`"

## Options for outputting HTML

# output:
#   rmarkdown::html_document:
#     theme: cerulean
#     toc: true
#     toc_depth: 2
#     toc_float: true
# 


## Options for outputting PDF
# output:
#   bookdown::pdf_document2:
#     fig_caption: yes
#     toc: true
#     number_sections: false
#     latex_engine: xelatex
#     includes:
#       in_header: preamble.tex
# mainfont: Avenir
# fontsize: 10pt
# geometry: left=2cm,right=2cm,top=2.5cm,bottom=2cm
# 

## Options for outputting Word
output: word_document
fontsize: 10pt

## Other options
editor_options: 
  chunk_output_type: console
params: 
  mode: "pdf"
---

\newpage

```{r readData}
library(here)
source(here("scripts/load.R"))
```

```{r utilityFunctions}
source(here("scripts/utils.R"))
```


# 1 Administration of questionnaire

## 1.1 Is this the original sampled household?

(per household)

```{r}
yao_hhld %>% 
  mutate(is_hhld_samp = str_replace_all(is_hhld_samp, c("0" = "Original", 
                                                        "1" = "Replacement"
                                                        ))) %>%
  mutate(is_hhld_samp = as.factor(is_hhld_samp)) %>% 
  countplotprint(is_hhld_samp, flip = T)
```

**NOTE** It is not clear to me whether 0 means "original" or "replacement".

## 1.3 Which surveyors administered the questionnaire?

(per respondent)

```{r}
yao %>% 
  mutate(name_researcher = str_replace_all(name_researcher, "_", ", ")) %>% 
  mutate(name_researcher = str_to_title(name_researcher)) %>% 
  countplotprint(name_researcher, fct_reorder = T, flip = T)
```

\newpage

## 1.4 Date of survey completion

(per respondent)

```{r fig.height=7}

yao %>% 
  countprop(dt_quest, date_parse = T) %>% 
  rename_for_countplot_axis() %>% 
  countplot(`Date Questionnaire Administered`, flip = T, date_parse = T, vjust_label = 0.5, hjust_label = -0.2) + 
  scale_x_date(date_breaks = "1 day", date_labels = "%b %d")

```

\newpage

## 1.5 City Area

(per household)

```{r fig.height=2.4}
yao_hhld %>% 
  mutate(loc_hhld_area = str_to_title(loc_hhld_area)) %>% 
  countplotprint(loc_hhld_area,  fct_reorder = T, flip = T)
```

\newpage

# 2 Household Composition

All variables below are per household. The answers from a single representative individual are taken to represent the information about the household.

This representative individual is either:

-   The first "household head" to be interviewed in a household; or
-   In cases where there is no head, the first individual above 18 to be interviewed in the household.

## 2.2 GPS location

```{r, fig.height=2}
for_map <- yao %>% 
  mutate(loc_hhld_lat = as.numeric(loc_hhld_lat), 
         loc_hhld_long = as.numeric(loc_hhld_long))


leaflet(options = leafletOptions(preferCanvas = TRUE) ) %>%
  addTiles() %>% 
  # Customers
  addMarkers(data = for_map, 
             lat = ~ loc_hhld_lat, 
             lng = ~ loc_hhld_long,
             clusterOptions = markerClusterOptions())  %>% 
  addCircleMarkers(data = for_map, lat = ~ loc_hhld_lat, lng = ~ loc_hhld_long, color = "black", radius = 2 ) 

```

```{r, eval=(params$mode == "pdf")}
"**NOTE**    The map above is a screenshot of an interactive web map. See the html version of this report to access map " %>% 
  data.frame() %>% 
  gt() %>% 
  fmt_markdown(columns = 1) %>%
  tab_options(column_labels.hidden = T)
```

## 2.3 Number of rooms

```{r}
yao_hhld %>% 
  mutate(n_hhld_rooms = as.factor(n_hhld_rooms)) %>% 
  countplotprint(n_hhld_rooms, fct_inseq = T, flip = F) 
```

## 2.4 Number of adults

```{r}
yao_hhld %>% 
  mutate(n_hhld_adults = as.factor(n_hhld_adults)) %>% 
  countplotprint(n_hhld_adults, fct_inseq = T, flip = F) 
```

## 2.5 Number of children

```{r}
yao_hhld %>%  
  mutate(n_hhld_children = as.factor(n_hhld_children)) %>% 
  countplotprint(n_hhld_children, fct_inseq = T, flip = F)
```

## 2.7 Have there been deaths in the household since March 1st?

```{r}
yao_hhld %>%  
  countplotprint(has_hhld_death, na_relevel = T, flip = T)
```

**NOTE** Here, NA means the cell was completely blank. NR means it was filled in as "Ne repond pas"

## 2.7.1 If there have been deaths in the household since March 1st, specify

All deaths reported are shown in the table below. No household had more than one death.

```{r }

death_dict <- read_excel(here("data/survey_data_dec_11.xlsx"), sheet = 4)

from_death_dict <- death_dict$from
to_death_dict <- death_dict$to 

death_dict <- setNames(object = to_death_dict, nm = from_death_dict)


yao_hhld %>%  
  filter(!is.na(dt_dead1_death)) %>% 
  select(dt_dead1_death, cat_dead1_sex, val_dead1_age, cat_dead1_cause) %>% 
  mutate(across( .fns = ~ str_replace_all(.x, death_dict))) %>% 
  mutate(dt_dead1_death = if_else( str_length(dt_dead1_death) != 10, NA_character_, dt_dead1_death ), 
         dt_dead1_death = as.Date(dt_dead1_death)) %>% 
  arrange(desc(dt_dead1_death)) %>% 
  mutate(dt_dead1_death = format.Date(dt_dead1_death, format = "%b %d" )) %>% 
  mutate(cat_dead1_sex = recode(cat_dead1_sex, "H" = "M")) %>% 
  rename(`Date of Death` = dt_dead1_death, 
         Sex = cat_dead1_sex, 
         `Age at Death` = val_dead1_age, 
         `Cause of Death` = cat_dead1_cause) %>% 
  huxtable() %>% 
  set_latex_float("h!") %>% 
  set_all_padding(0.5) %>%
  set_na_string("Unspecified") %>% 
  theme_blue()


  

```

\newpage

# 3 Information about the household

## 3.1 Are you the "Chef du menage"?

```{r}
yao %>%
  countplotprint(is_head,  na_relevel = T, flip = T)
```

## 3.2 Are you the principal breadwinner in the household?

```{r}
yao %>%
  countplotprint(is_breadwin, na_relevel = T, flip = T)
```

## 3.3 Who is the principal breadwinner in the household?

(Only answers from household representatives are shown.)

```{r fig.height = 3}
yao_hhld %>%
  plot_upset(mcat_breadwin)
```

## 3.4 What are the revenue sources of the family?

(Only answers from household representatives are shown.)

```{r fig.height = 3}
yao_hhld %>%
  plot_upset(mcat_rev_source, intersect_cutoff = 1)
```

## 3.4.1 If you answered "Other" to the previous question, specify

(Only answers from household representatives are shown.)

```{r}

yao_hhld %>% 
  filter(!is.na(cat_rev_source_other)) %>%
  mutate(cat_rev_source_other = str_to_title(cat_rev_source_other)) %>% 
  mutate(cat_rev_source_other = stri_trans_general(cat_rev_source_other, "Latin-ASCII") ) %>% 
  count(cat_rev_source_other) %>% 
  rename(`Other income source` = cat_rev_source_other) %>% 
  arrange(-n) %>%
  huxtable() %>% 
  set_latex_float("h!") %>% 
  set_all_padding(1.5) %>% 
  theme_blue()

```

## 3.5 Since March 1st, has the revenue of the household diminished?

(Only answers from household representatives are shown.)

```{r}
yao_hhld %>%
  countplotprint(has_rev_dropped,fct_reorder = T, na_relevel = T, flip = T)
```

## 3.6 Has a household member lost their job or had their working hours reduced?

(Only answers from household representatives are shown.)

```{r}
yao_hhld %>%
  countplotprint(has_mem_lost_job,
                 fct_reorder = F,
                 na_relevel = T,
                 flip = T
                 )
```

## 3.7 Has a household member tested positive for COVID-19?

(Only answers from household representatives are shown.)

```{r}
yao_hhld %>%
    countplotprint(has_mem_tested_positive,
                   flip = T,
                   na_relevel = T)
```

## 3.7.1 If a household member has tested positive for COVID-19, specify

(Only answers from household representatives are shown.)

```{r}
yao_hhld %>%
  filter(!is.na(dt_test1_test)) %>% 
  mutate(dt_test1_test = as.character(dt_test1_test),
         dt_test1_test = recode(dt_test1_test, 
                                "05/08/2020" = "2020-08-05"), 
         dt_test1_test = as.Date(dt_test1_test)) %>% 
  select(dt_test1_test, val_test1_age, cat_test1_sex) %>% 
  rename( `Date of Test` = dt_test1_test, 
          Age = val_test1_age, 
          Sex = cat_test1_sex) %>% 
  huxtable() %>% 
  set_latex_float("h!") %>% 
  set_all_padding(1.5) %>%
  theme_blue()


```

\newpage

# 4. Socio-administrative information about the surveyed individual

## 4.1 Sex

```{r}
yao %>%
  mutate(cat_sex = str_replace_all(cat_sex, "femme", "Female"),
         cat_sex = str_replace_all(cat_sex, "homme", "Male")) %>%
  countplotprint(cat_sex, flip = T)

```

## 4.2 Age

```{r}
yao %>%
  mutate(val_age= as.numeric(val_age)) %>%
  mutate(val_age = cut(val_age, breaks = seq(from = 0, to = 100, by = 10))) %>%
  countplotprint(val_age, drop_unused = T)
```

## 4.3 Date of birth

```{r}
p <- 
  yao %>%
  mutate(dt_birth = lubridate::year(dt_birth))  %>%
  mutate(dt_birth = cut(dt_birth,
                        breaks = seq(from = min(.$dt_birth, na.rm = T),
                                     to = max(.$dt_birth, na.rm = T),
                                     by = 10),
                        dig.lab = 5)) %>%
  countplotprint(dt_birth) +
  theme(axis.text.x.bottom = element_text(size = 8))

print(p)
```

## 4.4 Education level

```{r}
yao %>%
  countplotprint(cat_educ, fct_reorder = T, flip = T, na_relevel = T)
```

## 4.5 "Are you currently a..." (occupation)

```{r fig.height = 4.2}

yao %>%
  # not sure what these are
  filter(mcat_occup != "") %>%
  plot_upset(mcat_occup, intersect_cutoff = 0)
```

## 4.5.1 If you answered "Other" to the previous question, specify

```{r}
yao %>% 
  filter(!is.na(cat_occup_other)) %>%
  mutate(cat_occup_other = str_to_title(cat_occup_other)) %>% 
  mutate(cat_occup_other = stri_trans_general(cat_occup_other, "Latin-ASCII") ) %>% 
  count(cat_occup_other) %>% 
  rename(`Other occupation` = cat_occup_other) %>% 
  arrange(-n) %>%
  huxtable() %>% 
  set_latex_float("h!") %>% 
  set_all_padding(1.5) %>%
  theme_blue()
```

\newpage

# 5. Symptoms suggestive of COVID-19

## 5.1 Since the 1st of March, have you had one or several of the following symptoms?

All respondents:

```{r fig.width = 7, fig.height = 3.5}

yao %>%
  plot_upset(mcat_symp,
             intersect_cutoff = 3,
             sep = "--",
             set_size_lab = "Set size \n(and % with this symptom)",
             intersect_size_lab = "Intersection size \n(and % with this combination)")

```

Subset of those who have had symptoms:

```{r fig.width = 7, fig.height = 3.5}

yao %>%
  filter(mcat_symp != "No symptoms") %>%
  plot_upset(mcat_symp,
             intersect_cutoff = 1,
             sep = "--",
             set_size_lab = "Set size \n(and % with this symptom)",
             intersect_size_lab = "Intersection size \n(and % with this combination)"
             )

```

Subset of those who had a positive IgG or IgM test:

```{r fig.width = 7, fig.height = 3.5}

yao %>%
  filter(cat_igg_result == "Positive" | cat_igm_result == "Positive") %>%
  plot_upset(mcat_symp,
             intersect_cutoff = 3,
             sep = "--",
             set_size_lab = "Set size \n(and % with this symptom)",
             intersect_size_lab = "Intersection size \n(and % with this combination)"
             )

```

Subset of those who had negative test results for both the IgG and IgM:

```{r fig.width = 7, fig.height = 3.5}

yao %>%
  filter(cat_igg_result == "Negative" & cat_igm_result == "Negative") %>%
  plot_upset(mcat_symp,
             intersect_cutoff = 3,
             sep = "--",
             set_size_lab = "Set size \n(and % with this symptom)",
             intersect_size_lab = "Intersection size \n(and % with this combination)"
             )
```

\newpage

## 5.1.1 If you answered "other" to the previous question, specify

```{r}

yao %>% 
  filter(!is.na(cat_symp_other)) %>% 
  count(cat_symp_other) %>% 
  rename(`Additional Symptom` = cat_symp_other) %>% 
  huxtable() %>% 
  set_latex_float("h!") %>% 
  set_all_padding(1.5) %>%
  theme_blue()

```

## 5.1.2 How severe have your symptoms been?

(Among those with symptoms)

```{r}
yao %>%
  filter(mcat_symp != "No symptoms" & !is.na(mcat_symp) & mcat_symp != "") %>%
  countplotprint(cat_symp_severity, flip = T, na_relevel = T)
```

## 5.1.3 FOr how many days were you bedridden?

(Among those with symptoms)

```{r}

lump_below <- quantile(yao$n_bedridden_days, 0.95, na.rm = T) %>% as.numeric() %>% round()
max_val <- max(yao$n_bedridden_days, na.rm = T)
min_val <- min(yao$n_bedridden_days, na.rm = T)
min_max_range <- min_val:max_val


yao %>%
  filter(mcat_symp != "No symptoms" & !is.na(mcat_symp) & mcat_symp != "") %>%
  mutate(n_bedridden_days = factor(n_bedridden_days, levels = min_max_range)) %>%
  mutate(n_bedridden_days = as.numeric(n_bedridden_days),
         n_bedridden_days = cut(n_bedridden_days,
                              breaks = c( 0 : lump_below , max_val),
                              labels = c(as.character( 0 : (lump_below - 1)),
                                         paste0(lump_below,  " - ", max_val )
                                         ),
                              dig.lab = 5)) %>%
  countplotprint(n_bedridden_days, fct_inseq = T, drop_unused = F)

```

## 5.1.3 For how many days were you unable to go to work?

(Among those with symptoms)

```{r}


lump_below <- quantile(yao$n_days_miss_work, 0.95, na.rm = T) %>% as.numeric() %>% round()
max_val <- max(yao$n_days_miss_work, na.rm = T)
min_val <- min(yao$n_days_miss_work, na.rm = T)
min_max_range <- min_val:max_val


yao %>%
  filter(mcat_symp != "No symptoms" & !is.na(mcat_symp) & mcat_symp != "") %>%
  mutate(n_days_miss_work = factor(n_days_miss_work, levels = min_max_range)) %>%
  mutate(n_days_miss_work = as.numeric(n_days_miss_work),
         n_days_miss_work = cut(n_days_miss_work,
                              breaks = c( 0 : lump_below , max_val),
                              labels = c(as.character( 0 : (lump_below - 1)),
                                         paste0(lump_below,  " - ", max_val )
                                         ),
                              dig.lab = 5)) %>%
  countplotprint(n_days_miss_work, fct_inseq = T, drop_unused = F)

```

\newpage

# 6 Treatment course for symptoms characteristic of COVID-19

## 6.1 Since March 1st, have you sought medical care for symptoms characteristic of COVID-19?

```{r}

yao %>%
  countplotprint(has_consult_care, na_relevel = T, flip = T)

```

## 6.1.1 Who/Where did you consult for your symptoms?

(Among those who have consulted care.)

```{r fig.width= 7,  fig.height = 3.7}

yao %>%
  filter(has_consult_care == "Yes") %>%
  plot_upset(cat_col = mcat_consult,
             sep = "--")

```

\newpage

## 6.1.1.1 If you answered Other to the previous question, specify

```{r}

yao %>% 
  filter(!is.na(cat_consult_other)) %>% 
  count(cat_consult_other) %>% 
  rename(`Place of consultation` = cat_consult_other) %>% 
  huxtable() %>% 
  set_latex_float("h!") %>% 
  set_all_padding(1.5) %>%
  theme_blue()

```

## 6.2 Have you taken one or several medications for symptoms characteristic of COVID-19?

(Among those who had symptoms)

```{r fig.height = 4}

yao_symptoms <- 
  yao %>% 
  filter(mcat_symp != "No symptoms")


yao %>%
  filter(mcat_symp != "No symptoms") %>%
  filter(mcat_drug != "No response") %>%
  filter(!is.na(mcat_drug)) %>% 
  plot_upset(cat_col = mcat_drug,
             intersect_cutoff = 2,
             denom = yao_symptoms,
             sep = "--"
             )

```

\newpage

### 6.2.1 If you answered "Other" to the previous question, specify

```{r}
drug_table <- 
  yao %>%
  count(cat_drug_other) %>%
  filter(!is.na(cat_drug_other)) %>%
  uncount(n) %>% 
  separate_rows(cat_drug_other, sep = ",") %>% 
  mutate(cat_drug_other = str_replace_all(cat_drug_other, "antipa", "anti pa"), 
         cat_drug_other = str_replace_all(cat_drug_other, "-", " "), 
         cat_drug_other = str_trim(cat_drug_other),
         cat_drug_other = str_to_title(cat_drug_other)
         ) %>%
  count(cat_drug_other) %>% 
  arrange(-n) %>% 
  rename("Drug" = 1)


tab_length <- nrow(drug_table)
half_tab_length <- (nrow(drug_table)/2) %>% ceiling()

drug_table1 <- 
  drug_table[1 : half_tab_length ,      ] 
  
drug_table2 <- 
  drug_table[ (half_tab_length + 1) : tab_length, ] %>% 
  rename(`Drug ` = Drug , `n ` = n ) 

rows_to_add1 <- nrow(drug_table2) - nrow(drug_table1)
rows_to_add2 <- nrow(drug_table1) - nrow(drug_table2)


if (rows_to_add1 > 0){
  drug_table1 <- 
    drug_table1 %>% 
    add_row(Drug = rep(NA_character_, rows_to_add1), 
            n = rep(NA_integer_, rows_to_add1))
}

if (rows_to_add2 > 0){
  drug_table2 <- 
    drug_table2 %>% 
    add_row(`Drug ` = rep(NA_character_, rows_to_add2), 
            `n ` = rep(NA_integer_, rows_to_add2))
}
  
drug_table1 %>% 
  add_column(drug_table2) %>% 
  huxtable() %>% 
  set_latex_float("h!") %>% 
  set_all_padding(1.5) %>%
  theme_blue()

```

\newpage

<!-- ## 6.2.2 Were the medications described above recommended by ... -->

<!-- ```{r} -->

<!-- yao %>%  -->

<!--   filter(mcat_drugsource != "") %>%  -->

<!--   plot_upset(mcat_drugsource) -->

<!-- ``` -->

## 6.4 Have you been hospitalized since March 1st?

```{r fig.height = 3, fig.width= 7}

yao %>%
  plot_upset(mcat_hospitalised)

```

<!-- ## 6.4.1 Location of hospitalization  -->

<!-- ```{r} -->

<!-- ``` -->

## 6.5 If you have taken steps to access care regarding suspected or confirmed COVID-19, did you pay?

```{r fig.height = 3, fig.width= 7}

yao %>%
  filter(mcat_cost != "") %>%
  plot_upset(mcat_cost)

```

## 6.6 Have you participated in a prior COVID 19 Study?

```{r}
yao %>%
  countplotprint(has_partic_COVID_study, flip = T)

```

\newpage

# 7 Sequelae following COVID-19-like symptoms

## 7.1 Have you had health problems which have persisted after having COVID-like symptoms?

(Subsetted to those who showed COVID-like symptoms)

```{r}
yao %>%
  filter(mcat_symp != "No symptoms" & !is.na(mcat_symp) & mcat_symp != "") %>%
  countplotprint(has_sequela, flip = T, na_relevel = T)

```

## 7.1.1 If yes to the prior question, specify

```{r fig.height = 3.5}
yao %>%
  filter(mcat_symp != "No symptoms" & !is.na(mcat_symp) & mcat_symp != "") %>%
  filter(mcat_sequela != "") %>%
  plot_upset(mcat_sequela)

```

\newpage

# 8 COVID-19 tests carried out before the visit

## 8.1 Have you carried out any screening test for COVID-19?

```{r}
yao %>%
  countplotprint(has_tested, na_relevel = T, flip = T)
```

## 8.1.2 If you have previously had a COVID test, for what reason was the test done?

```{r fig.height=3.5, fig.width= 7}
yao %>%
  filter(mcat_test_reason != "") %>%
  plot_upset(mcat_test_reason)

```

## 8.1.1.1 If you responded "Other" to the previous question, specify

```{r}
yao %>% 
  filter(!is.na(cat_test_reason_other)) %>% 
  count(cat_test_reason_other) %>% 
  arrange(-n) %>% 
  rename(`Reasons for testing` = cat_test_reason_other) %>% 
  huxtable() %>% 
  set_latex_float("h!") %>% 
  set_all_padding(1.5) %>%
  theme_blue()

```

\newpage

# 9 Comorbidities, risk factors

## 9.1 What is your height (in cm)?

```{r}

min_height <- min(yao$val_height_cm, na.rm = T)
max_height <- max(yao$val_height_cm, na.rm = T)


yao %>% 
  mutate(val_height_cm= as.numeric(val_height_cm)) %>%
  mutate(val_height_cm = cut(val_height_cm, breaks = seq(from = min_height, to = max_height, by = 25))) %>%
  countplotprint(val_height_cm, remove_titles = F)

```

## 9.2 What is your weight (in kg)?

```{r}

min_weight <- min(yao$val_weight_kg, na.rm = T)
max_weight <- max(yao$val_weight_kg, na.rm = T)


yao %>% 
  mutate(val_weight_kg= as.numeric(val_weight_kg)) %>%
  mutate(val_weight_kg = cut(val_weight_kg, breaks = seq(from = min_weight, to = max_weight, by = 25))) %>%
  countplotprint(val_weight_kg, remove_titles = F)

```

## 9.3 Are you currently a smoker?

```{r}
yao %>% 
  countplotprint(is_smoker, flip = T, fct_reorder = T)
```

## 9.4 Do you suffer from any chronic health problems?

```{r}
yao %>% 
  countplotprint(has_chronic, flip = T, fct_reorder = T, na_relevel = T)
```

## 9.4.1 If you suffer from any health issues / chronic diseases, specify

(Only those who indicated health issues are shown. Thus, the denominator of the percentages is those with indicated issues.)

```{r fig.width=7, fig.height=4}
yao %>% 
  filter(!is.na(mcat_chronic) & mcat_chronic != "") %>%
  plot_upset(mcat_chronic, intersect_cutoff = 0)
```

\newpage

## 9.4.1.1 If you have answered "Other" to the previous question, specify

```{r}

yao %>% 
  filter(!is.na(cat_chronic_other)) %>%
  count(cat_chronic_other) %>%
  separate_rows(cat_chronic_other, sep = ",") %>% 
  mutate(cat_chronic_other = str_replace_all(cat_chronic_other, "-", " "), 
         cat_chronic_other = str_trim(cat_chronic_other),
         cat_chronic_other = str_to_title(cat_chronic_other), 
         cat_chronic_other = stri_trans_general(cat_chronic_other, "Latin-ASCII")
         ) %>% 
  uncount(n) %>% 
  count(cat_chronic_other) %>% 
  arrange(-n) %>% 
  huxtable() %>% 
  set_latex_float("h!") %>% 
  set_all_padding(0.5) %>%
  theme_blue()

```

## 9.5 Are you pregnant?

```{r}

yao %>% 
  countplotprint(is_pregnant, na_relevel = T, flip = T)

```

## 9.6 Do you take medications regularly?

```{r}
yao %>% 
  countplotprint(is_medicated, flip = T, na_relevel = T)
```

\newpage

<!-- ## 9.7 If you take medications regularly, which? -->

<!-- (See next page) -->

<!-- \newpage -->

<!-- ```{r} -->

<!-- drug_table <- -->

<!--   yao %>% -->

<!--   filter(!is.na(cat_medication) | cat_medication == "") %>% -->

<!--   count(cat_medication) %>% -->

<!--   mutate( -->

<!--     cat_medication = str_replace_all(cat_medication, "-", " "), -->

<!--     cat_medication = str_trim(cat_medication), -->

<!--     cat_medication = str_to_title(cat_medication), -->

<!--     cat_medication = stri_trans_general(cat_medication, "Latin-ASCII") -->

<!--   ) %>% -->

<!--   uncount(n) %>% -->

<!--   count(cat_medication) %>% -->

<!--   arrange(-n) %>%  -->

<!--   rename(Drug = cat_medication) -->

<!-- tab_length <- nrow(drug_table) -->

<!-- half_tab_length <- (nrow(drug_table)/2) %>% ceiling() -->

<!-- drug_table1 <-  -->

<!--   drug_table[1 : half_tab_length ,      ]  -->

<!-- drug_table2 <-  -->

<!--   drug_table[ (half_tab_length + 1) : tab_length, ] %>%  -->

<!--   rename(`Drug ` = Drug , `n ` = n )  -->

<!-- rows_to_add1 <- nrow(drug_table2) - nrow(drug_table1) -->

<!-- rows_to_add2 <- nrow(drug_table1) - nrow(drug_table2) -->

<!-- if (rows_to_add1 > 0){ -->

<!--   drug_table1 <-  -->

<!--     drug_table1 %>%  -->

<!--     add_row(Drug = rep(NA_character_, rows_to_add1),  -->

<!--             n = rep(NA_integer_, rows_to_add1)) -->

<!-- } -->

<!-- if (rows_to_add2 > 0){ -->

<!--   drug_table2 <-  -->

<!--     drug_table2 %>%  -->

<!--     add_row(`Drug ` = rep(NA_character_, rows_to_add2),  -->

<!--             `n ` = rep(NA_integer_, rows_to_add2)) -->

<!-- } -->

<!-- drug_table1 %>%  -->

<!--   add_column(drug_table2) %>%  -->

<!--   huxtable() %>%  -->

<!--   set_latex_float("h!") %>%  -->

<!--   set_all_padding(0.5) %>% -->

<!--   theme_blue() -->

<!-- ``` -->

<!-- \newpage -->

## 9.8 Have you been in contact with someone who had confirmed or suspected COVID?

```{r}

yao %>% 
  countplotprint(has_contact_COVID, flip = T)

```

## 9.9 Have you been in contact with someone coming from abroad?

```{r}

yao %>% 
  countplotprint(has_contact_traveller, flip = T)

```

## 9.10 Do you think that your risk of getting infected with the new virus is...?

```{r}
yao %>% 
  countplotprint(rate_virus_serious, flip = T)

```

\newpage

# 10 Difficulty of access to care

## 10.1 Since March 1st, have you had difficulty in obtaining medical care?

```{r}
yao %>%
  countplotprint(had_diffic_care, flip = T, na_relevel = T)
```

And, only among those who reported symptoms since March 1st or have a chronic condition:

```{r}
yao %>%
  mutate( # mark groups that dont need care as 0
    # dont need care if they have no symptoms
    needs_care = ifelse(test = (is.na(mcat_symp) | mcat_symp == "No symptoms" | mcat_symp == "No response") &
      # AND have no chronic condition
      (is.na(mcat_chronic) | mcat_chronic == "No response"),
      0,
      1
    )
  ) %>%
  # then filter them out
  filter(needs_care == 1) %>%
  countplotprint(had_diffic_care, flip = T, na_relevel = T)
```


## 10.1.1 If you had difficulty in obtaining medical care, specify

```{r}

yao %>%
  filter(!is.na(txt_diffic_care) | txt_diffic_care == "") %>%
  count(txt_diffic_care) %>%
  mutate(
    txt_diffic_care = str_replace_all(txt_diffic_care, "-", " "),
    txt_diffic_care = str_trim(txt_diffic_care),
    txt_diffic_care = str_to_title(txt_diffic_care),
    txt_diffic_care = stri_trans_general(txt_diffic_care, "Latin-ASCII")
  ) %>%
  uncount(n) %>%
  count(txt_diffic_care) %>%
  arrange(-n) %>% 
  rename(Difficulty = txt_diffic_care) %>% 
  huxtable() %>% 
  set_latex_float("h!") %>% 
  set_all_padding(1.5) %>%
  theme_blue()
```

\newpage

## 10.2 Since the first of March, have you been unable to access your usual medications?

```{r}
yao %>% 
  countplotprint(had_break_med, flip = T, na_relevel = T)
```


Only among those who answered "yes" to question 9.6, "do you take medications regularly?":

```{r}
yao %>% 
  filter(is_medicated == "Yes") %>% 
  countplotprint(had_break_med, flip = T, na_relevel = T)
```

And, only among those who reported symptoms since March 1st or have a chronic condition:

```{r}
yao %>% 
  mutate( # mark groups that dont need care as 0
    # dont need care if they have no symptoms
    needs_care = ifelse(test = (is.na(mcat_symp) | mcat_symp == "No symptoms" | mcat_symp == "No response") &
      # AND have no chronic condition
      (is.na(mcat_chronic) | mcat_chronic == "No response"),
      0,
      1
    )
  ) %>%
  # then filter them out
  filter(needs_care == 1) %>%
  countplotprint(had_break_med, flip = T, na_relevel = T)
```


## 10.2.1 If you have been unable to access your medications, what are the medications concerned?

```{r}
yao %>%
  filter(!is.na(txt_break_med) | txt_break_med == "") %>%
  count(txt_break_med) %>%
  mutate(
    txt_break_med = str_replace_all(txt_break_med, "-", " "),
    txt_break_med = str_trim(txt_break_med),
    txt_break_med = str_to_title(txt_break_med),
    txt_break_med = stri_trans_general(txt_break_med, "Latin-ASCII")
  ) %>%
  uncount(n) %>%
  count(txt_break_med) %>%
  arrange(-n) %>% 
  rename(Medication = txt_break_med) %>% 
  huxtable() %>% 
  set_latex_float("h!") %>% 
  set_all_padding(1.5) %>%
  theme_blue()

```

\newpage

# 11 Financial barriers to medical access

## 11.1 Do you have health insurance?

```{r}
yao %>% 
  countplotprint(has_insur, flip = T, na_relevel = T)
```

## 11.2 Since March 1st, have you had difficulty in paying your insurance primes?

```{r}
yao %>% 
  countplotprint(has_diffic_pay_insur, flip = T, na_relevel = T)

```

## 11.3 Since March 1st, have you encountered financial difficulty in paying for medical care or medications?

```{r}
yao %>% 
  countplotprint(has_diffic_pay_medic, flip = T, na_relevel = T)
```


And, only among those who reported symptoms since March 1st or have a chronic condition:
```{r}
yao %>% 
  mutate( # mark groups that dont need care as 0
    # dont need care if they have no symptoms
    needs_care = ifelse(test = (is.na(mcat_symp) | mcat_symp == "No symptoms" | mcat_symp == "No response") &
      # AND have no chronic condition
      (is.na(mcat_chronic) | mcat_chronic == "No response"),
      0,
      1
    )
  ) %>%
  # then filter them out
  filter(needs_care == 1) %>%
  countplotprint(has_diffic_pay_medic, flip = T, na_relevel = T)
```



## 11.4 Since March 1st, have you experienced delays in care for financial reasons?

```{r}
yao %>% 
  countplotprint(has_delay_care_finance, flip = T, na_relevel = T)
```


And, only among those who reported symptoms since March 1st or have a chronic condition:
```{r}
yao %>% 
  mutate( # mark groups that dont need care as 0
    # dont need care if they have no symptoms
    needs_care = ifelse(test = (is.na(mcat_symp) | mcat_symp == "No symptoms" | mcat_symp == "No response") &
      # AND have no chronic condition
      (is.na(mcat_chronic) | mcat_chronic == "No response"),
      0,
      1
    )
  ) %>%
  # then filter them out
  filter(needs_care == 1) %>%
  countplotprint(has_delay_care_finance, flip = T, na_relevel = T)
```



## 11.5 If you have sought out medical care due to suspicion or confirmation of COVID, did you have difficulty in paying for transport costs, care or medication?

```{r}
yao %>% 
  countplotprint(has_diffic_pay_transport, flip = T, na_relevel = T)
```

And, among those who have consulted care

```{r}
yao %>% 
  filter(has_consult_care == "Yes") %>% 
  countplotprint(has_diffic_pay_transport, flip = T, na_relevel = T)
```


## 11.6 Since March 1st, have you consulted care for non COVID-like symptoms?

```{r}
yao %>% 
  countplotprint(has_consult_non_COVID, flip = T, na_relevel = T)
```

\newpage

# 12 Other barriers to medical access (geography, perception)

## 12.2 Have you had difficulty in accessing medical centers due to inavailability or raised prices of transport?

```{r}
yao %>% 
  countplotprint(has_diffic_travel_care, flip = T, na_relevel = T)
```

And, only among those who reported symptoms since March 1st or have a chronic condition:

```{r}
yao %>% 
  mutate( # mark groups that dont need care as 0
    # dont need care if they have no symptoms
    needs_care = ifelse(test = (is.na(mcat_symp) | mcat_symp == "No symptoms" | mcat_symp == "No response") &
      # AND have no chronic condition
      (is.na(mcat_chronic) | mcat_chronic == "No response"),
      0,
      1
    )
  ) %>%
  # then filter them out
  filter(needs_care == 1) %>%
  countplotprint(has_diffic_travel_care, flip = T, na_relevel = T)
```


\newpage

## 12.2.1 Explain your answer to the previous question

```{r}

transport_bar_table <- 
  yao %>%
  filter(!is.na(cat_diffic_find_care_other) | cat_diffic_find_care_other == "") %>%
  count(cat_diffic_find_care_other) %>%
  mutate(
    cat_diffic_find_care_other = str_replace_all(cat_diffic_find_care_other, "-", " "),
    cat_diffic_find_care_other = str_trim(cat_diffic_find_care_other),
    cat_diffic_find_care_other = str_to_lower(cat_diffic_find_care_other),
    cat_diffic_find_care_other = stri_trans_general(cat_diffic_find_care_other, "Latin-ASCII"), 
    cat_diffic_find_care_other = str_wrap(cat_diffic_find_care_other, width = 44)
  ) %>%
  uncount(n) %>%
  count(cat_diffic_find_care_other) %>%
  arrange(-n) %>% 
  rename(Item = cat_diffic_find_care_other)



tab_length <- nrow(transport_bar_table)
half_tab_length <- (nrow(transport_bar_table)/2) %>% ceiling()

transport_bar_table1 <- 
  transport_bar_table[1 : half_tab_length ,      ]

transport_bar_table2 <- 
  transport_bar_table[ (half_tab_length + 1) : tab_length, ] %>% 
  rename(`Item ` = Item , `n ` = n ) 

rows_to_add1 <- nrow(transport_bar_table2) - nrow(transport_bar_table1)
rows_to_add2 <- nrow(transport_bar_table1) - nrow(transport_bar_table2)


if (rows_to_add1 > 0){
  transport_bar_table1 <- 
    transport_bar_table1 %>% 
    add_row(Item = rep(NA_character_, rows_to_add1), 
            n = rep(NA_integer_, rows_to_add1))
}

if (rows_to_add2 > 0){
  transport_bar_table2 <- 
    transport_bar_table2 %>% 
    add_row(`Item ` = rep(NA_character_, rows_to_add2), 
            `n ` = rep(NA_integer_, rows_to_add2))
}
  
transport_bar_table1 %>% 
  add_column(transport_bar_table2) %>% 
  huxtable() %>% 
  set_latex_float("h!") %>% 
  set_all_padding(0.5) %>%
  theme_blue()

```

\newpage

# 13 Behavior, hygiene, protective measures, physical distancing

## 13.1 Do you respect the simple rules of hygiene (sash hands frequently, sneeze into your elbow, use a disposable handkerchief, etc.)?

```{r}
yao %>% 
  countplotprint(is_respecting_hygiene, flip = T, na_relevel = T)
```

## 13.2 Do you respect the simple rules of social distancing (avoid handshakes or hugs, avoid unnecessary outings, etc.)?

```{r}
yao %>% 
  countplotprint(is_respecting_distancing, flip = T, na_relevel = T)
```

## 13.3 Since March 1st, have you remained confined?

```{r}
yao %>% 
  countplotprint(is_staying_confined, flip = T, na_relevel = T)
```

## 13.4 Since March 1st, have you been worried about contracting COVID-19?

```{r}
yao %>% 
  countplotprint(is_fearful_COVID, flip = T, na_relevel = T)
```

## 13.5 Since March 1st, have you been worried about the reaction of the people around you if you were to contract COVID-19?

```{r}
yao %>% 
  countplotprint(is_fearful_stigma, flip = T, na_relevel = T)
```

## 13.6 Do you think that people who contract COVID-19 are stigmatised and avoided by others?

```{r}
yao %>% 
  countplotprint(is_agreement_stigma_problem, flip = T, na_relevel = T)
```

## 13.7 Would you hide your illness if you were to contract COVID-19?

```{r}
yao %>% 
  countplotprint(is_agreement_hide_COVID, flip = T, na_relevel = T)
```

\newpage

# 14 Impact of the COVID-19 confinement on you

## 14.1 Since March 1st, have you been unable to carry out your daily activities (other than work, such as visiting family, making meals, taking care of the children...) because of the confinement?

```{r}
yao %>% 
  countplotprint(has_confin_disrupted, flip = T, na_relevel = T)
```

## 14.2 Since March 1st, have you stopped working or stopped one of your jobs due to the confinement?

```{r}
yao %>% 
  countplotprint(has_confin_stopped_work, flip = T, na_relevel = T)
```

## 14.3 Since March 1st, have you noticed an increase in stress for yourself or in your household, connected with the epidemic?

```{r}
yao %>% 
  countplotprint(has_confin_increased_stress, flip = T, na_relevel = T)
```

## 14.4 Within your household, have you faced since March 1st any physical or psychological violence?

```{r}
yao %>% 
  countplotprint(has_faced_violence, flip = T, na_relevel = T)
```

## 14.5 Since March 1st, have you received any material aid (money, meals, ...) from external sources?

```{r}
yao %>% 
  countplotprint(has_received_aid, flip = T, na_relevel = T)
```

\newpage

## 14.5.1 Specify the received items

(free response)

```{r}

aid_items_table <- 
  yao %>%
  filter(!is.na(txt_received_aid_specify) & txt_received_aid_specify != "") %>%
  count(txt_received_aid_specify) %>%
  mutate(
    txt_received_aid_specify = str_replace_all(txt_received_aid_specify, "-", " "),
    txt_received_aid_specify = str_trim(txt_received_aid_specify),
    txt_received_aid_specify = str_to_title(txt_received_aid_specify),
    txt_received_aid_specify = stri_trans_general(txt_received_aid_specify, "Latin-ASCII")
  ) %>%
  uncount(n) %>%
  count(txt_received_aid_specify) %>%
  arrange(-n) %>% 
  rename(`Item received` = txt_received_aid_specify)


tab_length <- nrow(aid_items_table)
half_tab_length <- (nrow(aid_items_table)/2) %>% ceiling()

aid_items_table1 <- 
  aid_items_table[1 : half_tab_length ,      ]

aid_items_table2 <- 
  aid_items_table[ (half_tab_length + 1) : tab_length, ] %>% 
  rename(`Item received ` = `Item received` , `n ` = n ) 

rows_to_add1 <- nrow(aid_items_table2) - nrow(aid_items_table1)
rows_to_add2 <- nrow(aid_items_table1) - nrow(aid_items_table2)


if (rows_to_add1 > 0){
  aid_items_table1 <- 
    aid_items_table1 %>% 
    add_row(`Item received` = rep(NA_character_, rows_to_add1), 
            n = rep(NA_integer_, rows_to_add1))
}

if (rows_to_add2 > 0){
  aid_items_table2 <- 
    aid_items_table2 %>% 
    add_row(`Item received ` = rep(NA_character_, rows_to_add2), 
            `n ` = rep(NA_integer_, rows_to_add2))
}
  
aid_items_table1 %>% 
  add_column(aid_items_table2) %>% 
  huxtable() %>% 
  set_latex_float("h!") %>% 
  set_all_padding(0.5) %>%
  theme_blue()

```

## 14.5.2 If, since March 1st, you have received material aid from external sources, indicate which

```{r fig.height= 3}

yao %>%
  filter(!is.na(mcat_received_aid) & mcat_received_aid != "") %>%
  plot_upset(mcat_received_aid)

```

\newpage

## 14.5.2.1 If you responded "other" to the previous question, specify

```{r}
yao %>%
  filter(!is.na(txt_received_aid_other) & txt_received_aid_other != "") %>%
  count(txt_received_aid_other) %>%
  mutate(
    txt_received_aid_other = str_replace_all(txt_received_aid_other, "-", " "),
    txt_received_aid_other = str_trim(txt_received_aid_other),
    txt_received_aid_other = str_to_title(txt_received_aid_other),
    txt_received_aid_other = stri_trans_general(txt_received_aid_other, "Latin-ASCII")
  ) %>%
  uncount(n) %>%
  count(txt_received_aid_other) %>%
  arrange(-n) %>% 
  rename(`Help Source` = txt_received_aid_other) %>% 
  huxtable() %>% 
  set_latex_float("h!") %>% 
  set_all_padding(0.5) %>%
  theme_blue()


```

## 14.5.3 If, since March 1st, you have received external material aid, at what frequency has this come, compared with before the pandemic?

```{r}
yao %>% 
  countplotprint(cat_aid_frequency, flip = T)

```

\newpage

# 15 Screening done during the survey visit

## 15.1 Do you currently have one or several of the following symptoms?

```{r fig.width=7, fig.height=4.5}
yao %>% 
  plot_upset(mcat_symp_screen, intersect_cutoff = 2)

```

\newpage

## 15.1.1 If you answered "Other" to the previous question, specify

```{r fig.width=7, fig.height=4}
yao %>%
  filter(!is.na(cat_symp_screen_other) & cat_symp_screen_other != "") %>%
  count(cat_symp_screen_other) %>%
  mutate(
    cat_symp_screen_other = str_replace_all(cat_symp_screen_other, "-", " "),
    cat_symp_screen_other = str_trim(cat_symp_screen_other),
    cat_symp_screen_other = str_to_title(cat_symp_screen_other),
    cat_symp_screen_other = stri_trans_general(cat_symp_screen_other, "Latin-ASCII")
  ) %>%
  uncount(n) %>%
  count(cat_symp_screen_other) %>%
  arrange(-n) %>% 
  rename(`Additional Symptom` = cat_symp_screen_other) %>% 
  huxtable() %>% 
  set_latex_float("h!") %>% 
  set_all_padding(0.5) %>%
  theme_blue()

```

## 15.2 Oxygen saturation

"To be measured in case of COVID-like symptoms. Express as a percentage"

```{r}
yao %>%
  filter(!is.na(val_satur_oxygen) & val_satur_oxygen != "") %>%
  count(val_satur_oxygen) %>%
  arrange(-val_satur_oxygen) %>% 
  rename(`OXygen Saturation` = val_satur_oxygen) %>% 
  huxtable() %>% 
  set_latex_float("h!") %>% 
  set_all_padding(0.5) %>%
  theme_blue()

```

## 15.3 Breathing rate

"To be measured in case of COVID-like symptoms. Express as number of breaths per minute"

```{r}
yao %>%
  filter(!is.na(val_freq_respiration) & val_freq_respiration != "") %>%
  count(val_freq_respiration) %>%
  arrange(-val_freq_respiration) %>% 
  rename(`Breathing Rate` = val_freq_respiration) %>% 
  huxtable() %>% 
  set_latex_float("h!") %>% 
  set_all_padding(0.5) %>%
  theme_blue()
```

\newpage

# 16 Test done during the survey visit

## 16.1 Serologic test (whether or not carried out)

```{r}
yao %>% 
  countplotprint(cat_sero_test_done, flip = T)
```

## 16.1 If the serologic test was not done, specify why

```{r}
yao %>%
  filter(!is.na(txt_sero_fail_reason) & txt_sero_fail_reason != "") %>%
  mutate(txt_sero_fail_reason = str_to_lower(txt_sero_fail_reason)) %>% 
  count(txt_sero_fail_reason) %>%
  arrange(-n) %>% 
  rename(Reason = txt_sero_fail_reason) %>% 
  huxtable() %>% 
  set_latex_float("h!") %>% 
  set_all_padding(0.5) %>%
  theme_blue()
```

## 16.1.1 IgG test result

```{r}

yao %>% 
  countplotprint(cat_igg_result, flip = T)

```

## 16.1.1 IgM test result

```{r}

yao %>% 
  countplotprint(cat_igm_result, flip = T)

```

## 16.2 Was a sample taken for the antigen test?

```{r}

yao %>% 
  countplotprint(is_antigen_test_taken, flip = T)

```

\newpage

## 16.2.1 If the antigen test was not done, specify why

```{r}

antigen_reason_table <- 
  yao %>%
  filter(!is.na(txt_antigen_not_taken_reason) & txt_antigen_not_taken_reason != "") %>%
  mutate(txt_antigen_not_taken_reason = str_to_lower(txt_antigen_not_taken_reason), 
         txt_antigen_not_taken_reason = stri_trans_general(txt_antigen_not_taken_reason, "Latin-ASCII")
         ) %>% 
  count(txt_antigen_not_taken_reason) %>%
  arrange(-n) %>% 
  rename(Reason = txt_antigen_not_taken_reason) 


tab_length <- nrow(antigen_reason_table)
half_tab_length <- (nrow(antigen_reason_table)/2) %>% ceiling()

antigen_reason_table1 <- 
  antigen_reason_table[1 : half_tab_length ,      ]

antigen_reason_table2 <- 
  antigen_reason_table[ (half_tab_length + 1) : tab_length, ] %>% 
  rename(`Reason ` = Reason , `n ` = n ) 

rows_to_add1 <- nrow(antigen_reason_table2) - nrow(antigen_reason_table1)
rows_to_add2 <- nrow(antigen_reason_table1) - nrow(antigen_reason_table2)


if (rows_to_add1 > 0){
  antigen_reason_table1 <- 
    antigen_reason_table1 %>% 
    add_row(Reason = rep(NA_character_, rows_to_add1), 
            n = rep(NA_integer_, rows_to_add1))
}

if (rows_to_add2 > 0){
  antigen_reason_table2 <- 
    antigen_reason_table2 %>% 
    add_row(`Reason ` = rep(NA_character_, rows_to_add2), 
            `n ` = rep(NA_integer_, rows_to_add2))
}
  
antigen_reason_table1 %>% 
  add_column(antigen_reason_table2) %>% 
  huxtable() %>% 
  set_latex_float("h!") %>% 
  set_all_padding(0.5) %>%
  theme_blue()


```

## 16.2.1 Result of the antigen test

```{r}

yao %>% 
  countplotprint(cat_antigen_result, flip = T)

```

## 16.3 Was a sample taken for the PCR test?

```{r}

yao %>% 
  countplotprint(is_PCR_test_taken, flip = T)

```

\newpage

## 16.3.1 If the PCR test was not done, specify why

```{r}


PCR_reason_table <- 
  yao %>%
  filter(!is.na(txt_PCR_not_taken_reason) & txt_PCR_not_taken_reason != "") %>%
  mutate(txt_PCR_not_taken_reason = str_to_lower(txt_PCR_not_taken_reason), 
         txt_PCR_not_taken_reason = stri_trans_general(txt_PCR_not_taken_reason, "Latin-ASCII"), 
         txt_PCR_not_taken_reason = str_wrap(txt_PCR_not_taken_reason, width = 44)
         ) %>% 
  count(txt_PCR_not_taken_reason) %>%
  arrange(-n) %>% 
  rename(Reason = txt_PCR_not_taken_reason) 


tab_length <- nrow(PCR_reason_table)
half_tab_length <- (nrow(PCR_reason_table)/2) %>% ceiling()

PCR_reason_table1 <- 
  PCR_reason_table[1 : half_tab_length ,      ]

PCR_reason_table2 <- 
  PCR_reason_table[ (half_tab_length + 1) : tab_length, ] %>% 
  rename(`Reason ` = Reason , `n ` = n ) 

rows_to_add1 <- nrow(PCR_reason_table2) - nrow(PCR_reason_table1)
rows_to_add2 <- nrow(PCR_reason_table1) - nrow(PCR_reason_table2)


if (rows_to_add1 > 0){
  PCR_reason_table1 <- 
    PCR_reason_table1 %>% 
    add_row(Reason = rep(NA_character_, rows_to_add1), 
            n = rep(NA_integer_, rows_to_add1))
}

if (rows_to_add2 > 0){
  PCR_reason_table2 <- 
    PCR_reason_table2 %>% 
    add_row(`Reason ` = rep(NA_character_, rows_to_add2), 
            `n ` = rep(NA_integer_, rows_to_add2))
}
  
PCR_reason_table1 %>% 
  add_column(PCR_reason_table2) %>% 
  huxtable() %>% 
  set_latex_float("h!") %>% 
  set_all_padding(0.5) %>%
  theme_blue()

```

## 16.3.1 Result of the PCR test

```{r}

yao %>% 
  countplotprint(cat_PCR_result, flip = T)

```

\newpage

# 17 Recommendations to people with symptoms

```{r fig.width = 7, fig.height=4}
yao %>% 
  plot_upset(mcat_recommend)
```
